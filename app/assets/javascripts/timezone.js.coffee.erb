<%  require_dependency 'openkitchen/timezone' %>

class Timezone

  # Table of timezones ( Generated by OpenKitchen::TimeZone class )
  @table: <%= OpenKitchen::TimeZone::timezones_by_offset.to_json %>

  # Find first entry with matching timezone offset
  @lookup_by_offset: (_offset)->
    _offset =  _offset.toString()
    (tz for offset, tz of @table when _offset == offset)[0]

  # Return the guessed timezone for this browser
  @timezone: ->
    x = new Date
    @lookup_by_offset(-x.getTimezoneOffset())

$(document).ready =>

  # Find timezone selected marked for autofill
  tz_select = $(".time_zone select")
  $("select.timezone.autofill").val(Timezone.timezone())

